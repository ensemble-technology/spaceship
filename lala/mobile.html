<!DOCTYPE html>
<html manifest="cache.manifest">

<head>
    <meta charset="utf-8">
    <title>Anime UI</title>
    <!-- <meta name="viewport" content="width=device-width, user-scalable=0, minimal-ui"> -->
    <meta name="description" content="Anime UI — A-Frame">
    <script src="node_modules/aframe/dist/aframe.min.js"></script>
    <script src="node_modules/aframe-event-set-component/dist/aframe-event-set-component.js"></script>
    <script src="node_modules/aframe-draw-component/dist/aframe-draw-component.min.js"></script>
    <script src="node_modules/aframe-textwrap-component/dist/aframe-textwrap-component.min.js"></script>
    <script src="node_modules/aframe-text-component/dist/aframe-text-component.min.js"></script>
    <script src="node_modules/aframe-html-shader/dist/aframe-html-shader.js"></script>
    <script src="node_modules/whatwg-fetch/fetch.js"></script>
    <style type="text/css">
        #target {
            width: 500px;
            position: absolute;
        }

        #htmlTarget.hide {
            z-index: -1;
        }

        #target img {
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
        }

        #htmlTarget {
            position: absolute;
            z-index: 1;
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        #debug {
            position: absolute;
            bottom: 0;
            left: 0;
        }

        #ensemble-logo {
            position: absolute;
            height: 30px;
            z-index: 999;
            left: 10px;
            top: 10px;
        }

        .g-popup {
            background: rgba(0, 0, 0, 0.5);
            color: #ffffff;
            border: 2px solid #a0a0a0;
            font-family: sans-serif;
            font-size: 18px;
            max-width: 100%;
            margin-bottom: 10px;
        }

        .g-popup::before {
          content: "";
          display: inline-block;
          background-color: rgba(255,255,255,0.1);
          border-bottom: 1px solid #a0a0a0;
          height: 30px;
          width: 100%;
        }

        .g-popup ul {
          padding-left: 30px;
          padding-right: 30px;
            color: #fff;
        }

        .g-popup ul li {
            list-style: circle;
        }

        .popup-topbar {
            height: 30px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid #a0a0a0;
        }
        /* Right panel */

        .right-panel {
            position: absolute;
            right: 10px;
            top: 10px;
            width: 130px;
            z-index: 999;
        }

        .right-panel img {
            width: 100%;
        }

        .rp-child {
            /*background-color: rgba(255, 255, 255, 0.1);
          border: 1px solid #a0a0a0;*/
            width: 100%;
            color: #fff;
        }
        /* Top */

        .right-panel .rp-top-bar {}
        /* Mid */

        .right-panel .rp-mid-bar {}
        /* Bot */

        .right-panel .rp-bot-title-bar {}

        .right-panel .rp-bot-content-bar {}
    </style>
</head>

<body>
    <!-- Top Left Enemble Logo -->
    <img id="ensemble-logo" src="./ensemble-logo.png">

    <!-- Top Right Interface -->
    <div class="right-panel">
        <div class="rp-top-bar rp-child"><img src="./the-u-journey.png"></div>
        <div class="rp-mid-bar rp-child"><img src="./rp-mid-bg.png" alt=""></div>
        <div class="rp-bot-title-bar rp-child">PLAN THE WORK</div>
        <div class="rp-bot-content-bar rp-child">LOREM IPSUM</div>
    </div>

    <div id="htmlTarget" class="hide">
        <div id="target" class="ee-desc">
            <div class="popup-questions-content g-popup"></div>
            <div class="popup-subservices-content g-popup"></div>
            <!-- <img src="./svg.svg"> -->
        </div>
        <!-- <div id="emoji">〠</div>
    <div id="target">
      <h1>HELLO<span>★</span></h1>
      <span id="pre">A</span>
    </div> -->
    </div>
    <a-scene>
        <a-assets>
            <!-- BG  -->
            <!-- <img id="sky" src="stars_bg.jpg"> -->
            <!-- <img id="sky" src="stars_bg2.png"> -->
            <img id="sky" src="space.jpg">

            <!-- Panel stuff -->
            <img id="panel-dash" src="assets/details/dash.png">

            <img id="on-2" src="assets/hover/2.png">
            <img id="on-1" src="assets/hover/1.png">

            <img id="on-2-2" src="assets/hover/2-2.png">
            <img id="on-2-1" src="assets/hover/2-1.png">
            <img id="on-1-2" src="assets/hover/1-2.png">
            <img id="on-1-1" src="assets/hover/1-1.png">

            <!-- Buttons Standby -->
            <img id="standby-2-2-3" src="assets/standby/2-2-3.png">
            <img id="standby-2-2-2" src="assets/standby/2-2-2.png">
            <img id="standby-2-2-1" src="assets/standby/2-2-1.png">
            <img id="standby-2-1-3" src="assets/standby/2-1-3.png">
            <img id="standby-2-1-2" src="assets/standby/2-1-2.png">
            <img id="standby-2-1-1" src="assets/standby/2-1-1.png">
            <img id="standby-1-2-3" src="assets/standby/1-2-3.png">
            <img id="standby-1-2-2" src="assets/standby/1-2-2.png">
            <img id="standby-1-2-1" src="assets/standby/1-2-1.png">
            <img id="standby-1-1-3" src="assets/standby/1-1-3.png">
            <img id="standby-1-1-2" src="assets/standby/1-1-2.png">
            <img id="standby-1-1-1" src="assets/standby/1-1-1.png">

            <!-- Buttons Hover -->
            <img id="hover-2-2-3" src="assets/hover/2-2-3.png">
            <img id="hover-2-2-2" src="assets/hover/2-2-2.png">
            <img id="hover-2-2-1" src="assets/hover/2-2-1.png">
            <img id="hover-2-1-3" src="assets/hover/2-1-3.png">
            <img id="hover-2-1-2" src="assets/hover/2-1-2.png">
            <img id="hover-2-1-1" src="assets/hover/2-1-1.png">
            <img id="hover-1-2-3" src="assets/hover/1-2-3.png">
            <img id="hover-1-2-2" src="assets/hover/1-2-2.png">
            <img id="hover-1-2-1" src="assets/hover/1-2-1.png">
            <img id="hover-1-1-3" src="assets/hover/1-1-3.png">
            <img id="hover-1-1-2" src="assets/hover/1-1-2.png">
            <img id="hover-1-1-1" src="assets/hover/1-1-1.png">

            <!-- Buttons Clickdown -->
            <img id="clickdown-2-2-3" src="assets/clickdown/2-2-3.png">
            <img id="clickdown-2-2-2" src="assets/clickdown/2-2-2.png">
            <img id="clickdown-2-2-1" src="assets/clickdown/2-2-1.png">
            <img id="clickdown-2-1-3" src="assets/clickdown/2-1-3.png">
            <img id="clickdown-2-1-2" src="assets/clickdown/2-1-2.png">
            <img id="clickdown-2-1-1" src="assets/clickdown/2-1-1.png">
            <img id="clickdown-1-2-3" src="assets/clickdown/1-2-3.png">
            <img id="clickdown-1-2-2" src="assets/clickdown/1-2-2.png">
            <img id="clickdown-1-2-1" src="assets/clickdown/1-2-1.png">
            <img id="clickdown-1-1-3" src="assets/clickdown/1-1-3.png">
            <img id="clickdown-1-1-2" src="assets/clickdown/1-1-2.png">
            <img id="clickdown-1-1-1" src="assets/clickdown/1-1-1.png">

        </a-assets>

        <a-entity position="0 0 1" rotation="0 0 0">
          <a-camera position="0 0 0">
          <!-- <a-cursor color="#4CC3D9" fuse="true" timeout="600"></a-cursor> -->
            <a-entity cursor="fuse: true; timeout: 600; maxDistance: 10;" position="0 0 -1" geometry="primitive: ring; radius-inner: 0.03; radius-outer: 0.04;" material="color: red; shader: flat;">
              <a-animation begin="fusing" easing="linear" attribute="scale" fill="backwards" from="1 1 1" to="0.1 0.1 0.1"></a-animation>
              <a-animation begin="cursor-fusing" easing="linear" attribute="scale" fill="forwards" from="1 1 1" to="0.1 0.1 0.1"></a-animation>
            </a-entity>
          </a-camera>
        </a-entity>

        <!-- Initial text  -->
        <a-entity id="question-text" position="-3.1 0.7 -6">
            <a-entity text="text: What does the world" position="0 1 0" material="color: #ffffff"></a-entity>
            <a-entity text="text: call on you to do?" position="0.5 0 0" material="color: #ffffff"></a-entity>
        </a-entity>

        <!-- <a-entity style="font-size: 500px !important" id="plane-content" geometry="primitive:plane;width:5;height:10;" material="shader:html;target:.ee-desc;transparent:false;ratio: width;fps:0.3;side:double;" position="0 4 -3.5" rotation="5 0 0"></a-entity> -->
        <!-- <a-box id="theContent" color="#007aff" position="0 3 -3" depth="0.1" height="3"  draw="background: #e0e0e0" textwrap="textAlign: center; x: 128; y: 128; text: Hallow"></a-box> -->
        <a-entity id="lettersEntity" visible='false' geometry="primitive:plane;width:2.8;height:1;" rotation="0 0 0" position="0 1 -3" material="shader:html;target:#target;transparent:true;ratio:width;fps:1.5;"></a-entity>

        <a-entity position="0 -3.5 4">
            <a-entity position="0 0 0">
                <a-curvedimage src="#panel-dash" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="true"></a-curvedimage>
            </a-entity>

            <a-entity position="0 0 0">
                <a-curvedimage src="#on-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
            </a-entity>

            <a-entity position="0 0 0">
                <a-curvedimage src="#on-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
            </a-entity>

            <a-entity position="0 0 0">
                <a-curvedimage src="#on-2-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
            </a-entity>

            <a-entity position="0 0 0">
                <a-curvedimage src="#on-2-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
            </a-entity>

            <a-entity position="0 0 0">
                <a-curvedimage src="#on-1-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
            </a-entity>

            <a-entity position="0 0 0">
                <a-curvedimage src="#on-1-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
            </a-entity>
            <!-- First row  -->
            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-1-1-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-1-1-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="1-1-1" class="button-hitbox" color="#007aff" height="0.7" width="1.85" position="-2.81 1.35 -9.3" rotation="4 20 17" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-1-2-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-1-2-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="1-2-1" class="button-hitbox" color="#007aff" height="0.7" width="1.9" position="-1 1.7 -9.8" rotation="4 10 7" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-2-1-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-2-1-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="2-1-1" class="button-hitbox" color="#007aff" height="0.7" width="1.9" position="1 1.7 -9.8" rotation="4 -10 -7" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-2-2-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-2-2-1" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="2-2-1" class="button-hitbox" color="#007aff" height="0.7" width="1.85" position="2.81 1.35 -9.3" rotation="4 -20 -17" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <!-- Second row  -->
            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-1-1-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-1-1-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="1-1-2" class="button-hitbox" color="#007aff" height="0.7" width="1.7" position="-2.6 0.61 -9.3" rotation="4 20 16" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-1-2-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-1-2-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="1-2-2" class="button-hitbox" color="#007aff" height="0.69" width="1.6" position="-0.85 1.12 -9.3" rotation="4 10 6" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-2-1-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-2-1-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="2-1-2" class="button-hitbox" color="#007aff" height="0.69" width="1.6" position="0.85 1.12 -9.3" rotation="4 -10 -6" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-2-2-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-2-2-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="2-2-2" class="button-hitbox" color="#007aff" height="0.7" width="1.7" position="2.6 0.61 -9.3" rotation="4 -20 -16" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <!-- Third row  -->
            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-1-1-3" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-1-1-3" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="1-1-3" class="button-hitbox" color="#007aff" height="0.69" width="1.51" position="-2.4 -0.1 -9.3" rotation="4 20 16" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-1-2-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-1-2-3" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="1-2-3" class="button-hitbox" color="#007aff" height="0.67" width="1.5" position="-0.75 0.41 -9.3" rotation="4 10 4" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-2-1-2" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-2-1-3" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="2-1-3" class="button-hitbox" color="#007aff" height="0.67" width="1.5" position="0.75 0.41 -9.3" rotation="4 -10 -4" opacity="0" transparent="true"></a-plane>
            </a-entity>

            <a-entity position="0 0 0" toggleable>
                <a-curvedimage src="#hover-2-2-3" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-curvedimage src="#clickdown-2-2-3" height="7" radius="10" theta-length="100" rotation="0 130 0" visible="false"></a-curvedimage>
                <a-plane data-loc="2-2-3" class="button-hitbox" color="#007aff" height="0.69" width="1.51" position="2.4 -0.1 -9.3" rotation="4 -20 -16" opacity="0" transparent="true"></a-plane>
            </a-entity>
        </a-entity>

        <!-- Left wall  -->
        <!-- <a-plane
      color="#aaffee"
      height="0.7" width="3"
      position="-1.5 0.35 0"
      rotation="0 90 0"
      ></a-plane> -->

        <!-- Right wall  -->
        <!-- <a-plane
      color="#aaffee"
      height="0.7" width="3"
      position="1.5 0.35 0"
      rotation="0 -90 0"
      ></a-plane> -->

        <!-- Back wall  -->
        <!-- <a-plane
      color="#aaffee"
      height="1.5" width="3"
      position="0 0.75 1.5"
      rotation="0 180 0"
      ></a-plane> -->

        <!-- Front glass  -->
        <!-- <a-plane
      color="#ffaaee"
      height="3" width="3"
      position="0 2.25 -0.5"
      rotation="60 0 0"
      ></a-plane> -->

        <a-sky src="#sky"></a-sky>
    </a-scene>
    <script type="text/javascript">
        (function() {
            var jsonData;
            fetch('./txts/matrix.json')
                .then(function(response) {
                    return response.json();
                })
                .then(function(responseJson) {
                    jsonData = responseJson;
                    console.log(jsonData);
                    return;
                }).catch(function(error) {
                    console.error(error);
                });

            function generateTextWrapAttribute(string) {
                return "textAlign: center; x: 128; y: 128; text: " + string;
            }

            var selectedButton;

            var buttonHitboxes = document.querySelectorAll('[toggleable] .button-hitbox');
            for (var i = 0; i < buttonHitboxes.length; i++) {
                buttonHitboxes[i].addEventListener('click', function() {

                    document.querySelector('#lettersEntity').setAttribute('visible', 'true');
                    document.querySelector('#question-text').setAttribute('visible', 'false');

                    document.querySelector('a-camera').setAttribute('rotation', '0 30 0');
                    // document.querySelector('#theContent').setAttribute('textwrap', generateTextWrapAttribute(this.dataset.loc));
                    if (selectedButton !== undefined) {
                        document.querySelector('[src="#on-' + selectedButton.slice(0, -4) + '"]').setAttribute('visible', 'false'); // Hide active group
                        document.querySelector('[src="#on-' + selectedButton.slice(0, -2) + '"]').setAttribute('visible', 'false'); // Hide active sub-group
                        document.querySelector('[src="#clickdown-' + selectedButton + '"]').setAttribute('visible', 'false'); // Hide active button
                    }

                    document.querySelector('[src="#on-' + this.dataset.loc.slice(0, -4) + '"]').setAttribute('visible', 'true'); // Set new active group
                    document.querySelector('[src="#on-' + this.dataset.loc.slice(0, -2) + '"]').setAttribute('visible', 'true'); // Set new active sub-group
                    this.previousElementSibling.setAttribute('visible', 'true'); // Set clickdown on
                    this.previousElementSibling.previousElementSibling.setAttribute('visible', 'false'); // Set hover state off
                    selectedButton = this.dataset.loc; // Store the new selected button string on mem

                    if (jsonData !== undefined) {
                        var questions = jsonData[this.dataset.loc]['questions']
                        var questionsHTML = '';
                        questions.forEach(function(item, index) {
                            questionsHTML += '<li>' + item + '</li>';
                        });
                        questionsHTML = '<ul>' + questionsHTML + '</ul>';
                        document.querySelector('#target .popup-questions-content').innerHTML = questionsHTML;

                        var subservices = jsonData[this.dataset.loc]['subservices'];
                        var subservicesHTML = '';
                        subservices.forEach(function(item, index) {
                            subservicesHTML += '<li>' + item + '</li>';
                        });
                        subservicesHTML = '<ul>' + subservicesHTML + '</ul>';
                        document.querySelector('#target .popup-subservices-content').innerHTML = subservicesHTML;
                    }
                });

                buttonHitboxes[i].addEventListener('mouseenter', function() {
                    if (selectedButton !== this.dataset.loc) {
                        this.previousElementSibling.setAttribute('visible', 'false'); // Clickdown
                        this.previousElementSibling.previousElementSibling.setAttribute('visible', 'true'); // Hover
                        document.querySelector('[src="#on-' + this.dataset.loc.slice(0, -2) + '"]').setAttribute('visible', 'true');
                        document.querySelector('[src="#on-' + this.dataset.loc.slice(0, -4) + '"]').setAttribute('visible', 'true');
                    }
                });

                buttonHitboxes[i].addEventListener('mouseleave', function() {
                    if (selectedButton !== this.dataset.loc) {
                        this.previousElementSibling.setAttribute('visible', 'false'); // Clickdown
                        this.previousElementSibling.previousElementSibling.setAttribute('visible', 'false'); // Hover

                        document.querySelector('[src="#on-' + this.dataset.loc.slice(0, -2) + '"]').setAttribute('visible', 'false');
                        document.querySelector('[src="#on-' + this.dataset.loc.slice(0, -4) + '"]').setAttribute('visible', 'false');

                        if (selectedButton !== undefined) {
                            document.querySelector('[src="#on-' + selectedButton.slice(0, -4) + '"]').setAttribute('visible', 'true'); // Hide active group
                            document.querySelector('[src="#on-' + selectedButton.slice(0, -2) + '"]').setAttribute('visible', 'true'); // Hide active sub-group
                        }
                    }
                });
            }
        })();
    </script>
</body>

</html>
